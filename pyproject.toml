[tool.bandit]
exclude_dirs = [
    "test",
    "scripts",
    ".venv",
    "cdk.out"
]
skips = [
    "B403"
]

[tool.black]
line-length = 120

[tool.isort]
line_length = 120
profile = "black"
force_alphabetical_sort_within_sections = true
skip_glob = [
    "cdk.out/*"
]

[tool.mypy]
ignore_missing_imports = true
disallow_untyped_defs = true
disallow_untyped_decorators = false
disallow_incomplete_defs = true
disallow_any_unimported = false
no_implicit_optional = true
check_untyped_defs = true
warn_return_any = true
warn_unused_ignores = true
strict_optional = true
show_error_codes = true
explicit_package_bases = true
mypy_path = [
    "lambda",
    "lisa-sdk",
    "lib/serve/rest-api/src",
    "lib/serve/mcp-workbench/src",
]
exclude = [
    "^build/",
    "^dist/",
    "^\\.venv/",
    "^cdk\\.out/",
    "^node_modules/",
]

[tool.ruff]
line-length = 120

[tool.ruff.lint]
ignore = ["D401"]
select = ["E", "F", "W", "PLC0415"]  # Enable pycodestyle errors, pyflakes, warnings, and import-outside-toplevel

[tool.ruff.lint.per-file-ignores]
# Allow imports in functions for test files
"test/lambda/test_session_lambda.py" = ["E402", "PLC0415"]
"test/**/*.py" = ["E402", "PLC0415"]
"**/test_*.py" = ["E402", "PLC0415"]

[tool.pytest.ini_options]
addopts = "--strict-markers -vv -x"
markers = [
    "api: API tests",
    "cdk_deployed: CDK infrastructure deployed",
]
testpaths = [
    "test/python",
    "test/lambda",
    "test/mcp-workbench",
    "test/lisa-sdk",
]
pythonpath = [
    "lambda",
    "lisa-sdk",
    "lib/serve/rest-api/src",
    "lib/serve/mcp-workbench/src",
]
